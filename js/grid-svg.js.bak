// Grid SVG Generator - Inline SVG for dynamic color control

function generateInlineGridSVG() {
    const grid = document.getElementById('grid');
    if (!grid) return;
    
    // Clear any existing content
    const existingSvg = grid.querySelector('.grid-svg');
    if (existingSvg) {
        existingSvg.remove();
    }
    
    // Create SVG element
    const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
    svg.setAttribute('width', '100%');
    svg.setAttribute('height', '100%');
    svg.setAttribute('xmlns', 'http://www.w3.org/2000/svg');
    
    // Create defs for pattern
    const defs = document.createElementNS('http://www.w3.org/2000/svg', 'defs');
    
    // Create pattern element
    const pattern = document.createElementNS('http://www.w3.org/2000/svg', 'pattern');
    pattern.setAttribute('id', 'grid-pattern');
    pattern.setAttribute('x', '0');
    pattern.setAttribute('y', '0');
    pattern.setAttribute('width', '27');
    pattern.setAttribute('height', '27');
    pattern.setAttribute('patternUnits', 'userSpaceOnUse');
    
    // Create circle element for the dot
    const circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
    circle.setAttribute('cx', '13.5');
    circle.setAttribute('cy', '13.5');
    circle.setAttribute('r', '2');
    circle.setAttribute('fill', 'currentColor'); // Uses CSS color
    
    // Assemble the pattern
    pattern.appendChild(circle);
    defs.appendChild(pattern);
    svg.appendChild(defs);
    
    // Create rectangle that uses the pattern
    const rect = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
    rect.setAttribute('width', '100%');
    rect.setAttribute('height', '100%');
    rect.setAttribute('fill', 'url(#grid-pattern)');
    
    svg.appendChild(rect);
    
    // Add the SVG to the grid
    grid.appendChild(svg);
}

// Function to change grid color dynamically
function setGridColor(color) {
    const gridCircles = document.querySelectorAll('#grid-pattern circle');
    gridCircles.forEach(circle => {
        circle.style.fill = color;
    });
}

// Initialize on DOM ready
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', generateInlineGridSVG);
} else {
    generateInlineGridSVG();
}

// Export for use in other modules
window.generateInlineGridSVG = generateInlineGridSVG;
window.setGridColor = setGridColor;
